---
title: 'Handling imbalanced data with resampling'
excerpt: "It's not uncommon for data scientists to work on imabalnced data, i.e. such data where classes are not uniformly distributed and one or two classes present a vast majority. Actually, most of classification data is usually imbalanced. To name but a few: medical data to diagnose a condition, fraud detection data, churn client data etc."
permalink: /posts/imbalanced-ml/

---

<div style="text-align: justify;">It's not uncommon for data scientists to work on imabalnced data, i.e. such data where classes are not uniformly distributed and one or two classes present a vast majority. Actually, most of classification data is usually imbalanced. To name but a few: medical data to diagnose a condition, fraud detection data, churn client data etc.</div>
<p>
<div style="text-align: justify;">The problem here is that machine learning algorithms may overfit on the majority class and totally ignore the minor classes. At the same time, it is the minority class samples (a rare disease or a fraudulent transaction) that we are interested in detecting! One of the ways to overcome the problem of imbalanced data is resampling, i.e. changing the number of samples in the different classes. There are at least three ways to resample data:</div>
<p>

<ul>  
  <li>Oversampling: adding the minory class samples.</li>
  <li>Undersampling: deleting the majority class samples.</li>
  <li>Combination of oversampling and udnersampling.</li>
</ul>
  
<div style="text-align: justify;">In this notebook we will examine some popular resampling techniques as well as discover why Accuracy is not always a good evaluation metric.</div>

<div style="text-align: justify;">First, we will look at different resampling methods in action and plot the results. Afterwards we are going to create a classification model on imbalanced data with and without resampling.</div>

<h2>Resampling on synthetic data</h2>
<div style="text-align: justify;">Let's create some imbalanced data to demonstrate the differene between resampling methods.</div>
```
X, y = make_classification(n_samples=1000, n_features=2, n_informative=2,
                           n_redundant=0, n_repeated=0, n_classes=3,
                           n_clusters_per_class=1,
                           weights=[0.06, 0.02, 0.92],
                           class_sep=0.8, random_state=0)

colors = ['#4E6B8A' if v == 0 else '#F26419' if v == 1 else '#F6AE2D' for v in y]
fig = plt.Figure(figsize=(12,8))
plt.scatter(X[:, 0], X[:, 1], c=colors, edgecolors='grey', linewidths=0.5)
sns.despine()
```
